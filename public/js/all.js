angular.module("app",["ui.router","restangular","angularMoment","btford.markdown"]).run(["$rootScope","$state","$stateParams","$http",function(t,e,a,o){t.$state=e,t.$stateParams=a,t.wait=!0,o.get("/api/auth").then(function(e){t.authenticated=e.data,t.wait=!1}),t.$on("$stateChangeStart",function(a,o,l,r,s){t.wait||!o.authenticate||t.authenticated||(e.transitionTo(""==r.name?"home.index":r.name,s),a.preventDefault())})}]).config(["$stateProvider","$locationProvider","RestangularProvider",function(t,e,a){e.html5Mode(!0),a.setBaseUrl("/api"),t.state("home",{"abstract":!0,views:{main:{templateUrl:"/templates/home.html"}}}).state("home.index",{url:"/",views:{posts:{templateUrl:"/templates/post.list.html",controller:"PostListController"},categories:{templateUrl:"/templates/category.list.html",controller:"CategoryListController"},tags:{templateUrl:"/templates/tag.list.html",controller:"TagListController"}}}).state("auth",{"abstract":!0,views:{main:{templateUrl:"/templates/auth.html"}}}).state("auth.login",{url:"/auth/login",views:{auth:{templateUrl:"/templates/auth.login.html",controller:"AuthLoginController"}}}).state("auth.logout",{url:"/auth/logout",views:{auth:{templateUrl:"/templates/auth.logout.html",controller:"AuthLogoutController"}},authenticate:!0}).state("post",{"abstract":!0,views:{main:{templateUrl:"/templates/post.html"}}}).state("post.index",{url:"/posts",views:{posts:{templateUrl:"/templates/post.list.html",controller:"PostListController"}}}).state("post.create",{url:"/post/create",views:{posts:{templateUrl:"/templates/post.create.html",controller:"PostCreateController"}},authenticate:!0}).state("post.detail",{url:"/post/:id",views:{posts:{templateUrl:"/templates/post.detail.html",controller:"PostDetailController"}}}).state("post.edit",{url:"/post/:id/edit",views:{posts:{templateUrl:"/templates/post.edit.html",controller:"PostEditController"}},authenticate:!0}).state("tag",{"abstract":!0,views:{main:{templateUrl:"/templates/tag.html"}}}).state("tag.index",{url:"/tags",views:{tags:{templateUrl:"/templates/tag.list.html",controller:"TagListController"}}}).state("tag.create",{url:"/tag/create",views:{tags:{templateUrl:"/templates/tag.create.html",controller:"TagCreateController"}},authenticate:!0}).state("category",{"abstract":!0,views:{main:{templateUrl:"/templates/category.html"}}}).state("category.index",{url:"/categories",views:{categories:{templateUrl:"/templates/category.list.html",controller:"CategoryListController"}}}).state("category.create",{url:"/category/create",views:{categories:{templateUrl:"/templates/category.create.html",controller:"CategoryCreateController"}},authenticate:!0})}]).constant("angularMomentConfig",{timezone:moment.tz.guess()}).filter("localTime",function(){return function(t){return moment.utc(t).local()}}),angular.module("app").controller("CategoryListController",["$scope","Restangular",function(t,e){t.categories=e.all("category").getList().$object}]),angular.module("app").controller("CategoryCreateController",["$scope","Restangular",function(t,e){t.category={},t.create=function(t){e.all("category").post(t)},t.cancel=function(){a()};var a=function(){t.category=null,t.categoryForm.$setPristine()}}]),angular.module("app").controller("PostCreateController",["$scope","Restangular",function(t,e){t.tags=e.all("tag").getList().$object,t.categories=e.all("category").getList().$object,t.post={},t.create=function(t){e.all("post").post(t)},t.cancel=function(){a()};var a=function(){t.post=null,t.postForm.$setPristine()}}]),angular.module("app").controller("PostListController",["$scope","Restangular",function(t,e){t.posts=e.all("post").getList().$object}]),angular.module("app").controller("PostDetailController",["$scope","$stateParams","Restangular",function(t,e,a){t.post=a.one("post",e.id).get().$object}]),angular.module("app").controller("PostEditController",["$scope","$stateParams","Restangular",function(t,e,a){t.tags=a.all("tag").getList().$object,t.categories=a.all("category").getList().$object,a.one("post",e.id).get().then(function(e){t.post=e,t.post.categories=_.map(t.post.categories,"id"),t.post.tags=_.map(t.post.tags,"id")}),t.update=function(t){t.save()},t.cancel=function(){o()};var o=function(){t.post=null,t.postForm.$setPristine()}}]),angular.module("app").controller("TagListController",["$scope","Restangular",function(t,e){t.tags=e.all("tag").getList().$object}]),angular.module("app").controller("TagCreateController",["$scope","Restangular",function(t,e){t.category={},t.create=function(t){e.all("tag").post(t)},t.cancel=function(){a()};var a=function(){t.tag=null,t.tagForm.$setPristine()}}]);